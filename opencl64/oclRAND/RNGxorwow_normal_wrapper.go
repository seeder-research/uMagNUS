package oclRAND

/*
 THIS FILE IS AUTO-GENERATED BY OCL2GO.
 EDITING IS FUTILE.
*/

import (
	"github.com/seeder-research/uMagNUS/cl"
	"github.com/seeder-research/uMagNUS/timer"
	"sync"
	"unsafe"
)

// Stores the arguments for xorwow_normal kernel invocation
type xorwow_normal_args_t struct {
	arg_state_buf unsafe.Pointer
	arg_d_data    unsafe.Pointer
	arg_count     int
	argptr        [3]unsafe.Pointer
	sync.Mutex
}

// Stores the arguments for xorwow_normal kernel invocation
var xorwow_normal_args xorwow_normal_args_t

func init() {
	// OpenCL driver kernel call wants pointers to arguments, set them up once.
	xorwow_normal_args.argptr[0] = unsafe.Pointer(&xorwow_normal_args.arg_state_buf)
	xorwow_normal_args.argptr[1] = unsafe.Pointer(&xorwow_normal_args.arg_d_data)
	xorwow_normal_args.argptr[2] = unsafe.Pointer(&xorwow_normal_args.arg_count)
}

// Wrapper for xorwow_normal OpenCL kernel, asynchronous.
func k_xorwow_normal_async(state_buf unsafe.Pointer, d_data unsafe.Pointer, count int, cfg *config, events []*cl.Event) *cl.Event {
	if Synchronous { // debug
		ClCmdQueue.Finish()
		timer.Start("xorwow_normal")
	}

	xorwow_normal_args.Lock()
	defer xorwow_normal_args.Unlock()

	xorwow_normal_args.arg_state_buf = state_buf
	xorwow_normal_args.arg_d_data = d_data
	xorwow_normal_args.arg_count = count

	SetKernelArgWrapper("xorwow_normal", 0, state_buf)
	SetKernelArgWrapper("xorwow_normal", 1, d_data)
	SetKernelArgWrapper("xorwow_normal", 2, count)

	//	args := xorwow_normal_args.argptr[:]
	event := LaunchKernel("xorwow_normal", cfg.Grid, cfg.Block, events)

	if Synchronous { // debug
		ClCmdQueue.Finish()
		timer.Stop("xorwow_normal")
	}

	return event
}
